<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aegis Wallet Integration Demo</title>
</head>
<body>
    <h1>Aegis Wallet Integration Demo</h1>
    <p>Open the browser console to see the cryptographic operations.</p>

    <script type="module">
        import init, {
            kyber_keygen,
            dilithium_keygen,
            dilithium_sign,
            dilithium_verify,
            falcon_keygen,
            falcon_sign,
            falcon_verify,
        } from "../pkg/aegis_crypto_core.js";

        async function runDemo() {
            console.log('--- Wallet Integration Demo ---');
            await init();
            console.log('WASM module initialised');

            // Generate key pairs
            const kyberPair = kyber_keygen();
            const dilithiumPair = dilithium_keygen();
            const falconPair = falcon_keygen();
            console.log('Kyber public key length:', kyberPair.public_key.length);
            console.log('Dilithium public key length:', dilithiumPair.public_key.length);
            console.log('Falcon public key length:', falconPair.public_key.length);

            // Sign and verify a message
            const msg = new TextEncoder().encode('0x123abc (transaction hash)');
            const dilithiumSig = dilithium_sign(dilithiumPair.secret_key, msg);
            const isDilithiumValid = dilithium_verify(dilithiumPair.public_key, msg, dilithiumSig);
            console.log('Dilithium signature valid:', isDilithiumValid);
            const falconSig = falcon_sign(falconPair.secret_key, msg);
            const isFalconValid = falcon_verify(falconPair.public_key, msg, falconSig);
            console.log('Falcon signature valid:', isFalconValid);
        }

        runDemo().catch((err) => {
            console.error(err);
        });
    </script>
</body>
</html>